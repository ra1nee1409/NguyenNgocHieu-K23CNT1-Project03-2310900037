<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
</head>

<body>
    <div th:replace="~{user/fragments/user-layout :: layout(~{::title}, ~{::content})}">
        <title>Lịch sử đơn hàng - Ra1nee Store</title>

        <div th:fragment="content">
            <style>
                .history-container {
                    max-width: 1200px;
                    margin: 2rem auto;
                }

                .order-card {
                    transition: transform 0.2s;
                }

                .order-card:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                }
            </style>

            <div class="history-container">
                <h2 class="mb-4"><i class="bi bi-clock-history"></i> Lịch sử đơn hàng</h2>

                <!-- Empty State -->
                <div th:if="${orders.isEmpty()}" class="text-center py-5">
                    <i class="bi bi-inbox fs-1 text-muted"></i>
                    <h4 class="mt-3">Chưa có đơn hàng nào</h4>
                    <p class="text-muted">Hãy mua sắm và đặt hàng ngay!</p>
                    <a href="/home" class="btn btn-primary mt-3">
                        <i class="bi bi-shop"></i> Tiếp tục mua sắm
                    </a>
                </div>

                <!-- Orders List -->
                <div th:unless="${orders.isEmpty()}">
                    <div class="card order-card shadow-sm mb-3" th:each="order : ${orders}">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <!-- Order Info -->
                                <div class="col-md-3">
                                    <h5 class="mb-1">Đơn hàng #<span th:text="${order.id}">123</span></h5>
                                    <small class="text-muted">
                                        <i class="bi bi-calendar"></i>
                                        <span th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">01/01/2025 10:00</span>
                                    </small>
                                </div>

                                <!-- Products Count -->
                                <div class="col-md-2">
                                    <div class="text-muted small">Sản phẩm</div>
                                    <strong><span th:text="${order.orderItems.size()}">3</span> món</strong>
                                </div>

                                <!-- Total Amount -->
                                <div class="col-md-3">
                                    <div class="text-muted small">Tổng tiền</div>
                                    <strong class="text-danger" 
                                            th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')} + '₫'">
                                        1,000,000₫
                                    </strong>
                                </div>

                                <!-- Status -->
                                <div class="col-md-2">
                                    <span class="badge" 
                                          th:classappend="${order.status.name() == 'PENDING'} ? 'bg-warning text-dark' : 
                                                          (${order.status.name() == 'CONFIRMED'} ? 'bg-info' : 
                                                          (${order.status.name() == 'SHIPPING'} ? 'bg-primary' : 
                                                          (${order.status.name() == 'DELIVERED'} ? 'bg-success' : 
                                                          (${order.status.name() == 'COMPLETED'} ? 'bg-dark' : 'bg-danger'))))">
                                        <span th:if="${order.status.name() == 'PENDING'}">Đặt hàng</span>
                                        <span th:if="${order.status.name() == 'CONFIRMED'}">Đã xác nhận</span>
                                        <span th:if="${order.status.name() == 'SHIPPING'}">Đang giao</span>
                                        <span th:if="${order.status.name() == 'DELIVERED'}">Đã tới điểm giao</span>
                                        <span th:if="${order.status.name() == 'COMPLETED'}">Hoàn thành</span>
                                        <span th:if="${order.status.name() == 'CANCELLED'}">Đã hủy</span>
                                    </span>
                                </div>

                                <!-- Action -->
                                <div class="col-md-2 text-end">
                                    <a th:href="@{/orders/{id}(id=${order.id})}" class="btn btn-outline-primary btn-sm">
                                        <i class="bi bi-eye"></i> Xem chi tiết
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
