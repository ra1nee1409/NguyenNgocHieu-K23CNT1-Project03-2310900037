<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{admin/fragments/admin-layout :: head}"></head>

<body class="bg-gray-100">
    <!-- Navbar -->
    <nav th:replace="~{admin/fragments/admin-layout :: navbar}"></nav>

    <div class="flex">
        <!-- Sidebar -->
        <aside th:replace="~{admin/fragments/admin-layout :: sidebar}"></aside>

        <!-- Main Content -->
        <main class="flex-1 p-8">
            <div class="max-w-7xl mx-auto">
                <!-- Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-900 flex items-center gap-2">
                        <i class="fas fa-star text-yellow-500"></i>
                        Quản lý đánh giá
                    </h1>
                    <p class="text-gray-600 mt-2">Xem và quản lý tất cả đánh giá sản phẩm</p>
                </div>

                <!-- Success/Error Messages -->
                <div th:if="${successMessage}" class="mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
                    <i class="fas fa-check-circle mr-2"></i>
                    <span th:text="${successMessage}"></span>
                </div>
                <div th:if="${errorMessage}" class="mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span th:text="${errorMessage}"></span>
                </div>

                <!-- Reviews Table -->
                <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sản phẩm</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Người dùng</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Đánh giá</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bình luận</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ngày tạo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr th:if="${reviews.isEmpty()}">
                                <td colspan="7" class="px-6 py-12 text-center text-gray-500">
                                    <i class="fas fa-comment-slash text-4xl mb-2"></i>
                                    <p>Chưa có đánh giá nào</p>
                                </td>
                            </tr>
                            <tr th:each="review : ${reviews}" class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${review.id}">1</td>
                                <td class="px-6 py-4 text-sm text-gray-900">
                                    <a th:href="@{/product/{id}(id=${review.nnhProduct.id})}" 
                                       class="text-primary-600 hover:text-primary-800 hover:underline"
                                       th:text="${review.nnhProduct.name}">Product Name</a>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" th:text="${review.nnhUser.fullName}">User Name</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <div class="flex gap-1">
                                        <i th:each="i : ${#numbers.sequence(1, 5)}" 
                                           th:class="${i <= review.rating} ? 'fas fa-star text-yellow-500 text-xs' : 'far fa-star text-yellow-500 text-xs'"></i>
                                    </div>
                                </td>
                                <td class="px-6 py-4 text-sm text-gray-900 max-w-xs truncate" th:text="${review.comment}">Comment</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" 
                                    th:text="${#temporals.format(review.createdAt, 'dd/MM/yyyy HH:mm')}">01/01/2024</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <form th:action="@{/admin/reviews/delete/{id}(id=${review.id})}" 
                                          method="post" 
                                          onsubmit="return confirm('Bạn có chắc chắn muốn xóa đánh giá này?');"
                                          class="inline">
                                        <button type="submit" 
                                                class="text-red-600 hover:text-red-900 font-medium">
                                            <i class="fas fa-trash mr-1"></i> Xóa
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
</body>

</html>
